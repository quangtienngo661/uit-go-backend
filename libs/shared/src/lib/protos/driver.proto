syntax = "proto3";

package driverPackage;

import "google/protobuf/timestamp.proto";
import "common.proto";

service DriverService {
  rpc UpdateStatus (UpdateStatusRequest) returns (UpdateStatusResponse);
  rpc UpdateLocation (UpdateLocationRequest) returns (UpdateLocationResponse);
  rpc FindNearbyDrivers (FindNearbyDriversRequest) returns (FindNearbyDriversResponse);
  rpc GetDriverProfile (GetDriverProfileRequest) returns (GetDriverProfileResponse);
  rpc AcceptTrip (AcceptTripRequest) returns (AcceptTripResponse);
  rpc RejectTrip (RejectTripRequest) returns (RejectTripResponse);
}

// Re-useable message
message DriverStatusWrapper {
  common.DriverStatus statusId = 1;
  string status = 2;
}

// Update Status
message UpdateStatusRequest {
  string driverId = 1;
  DriverStatusWrapper status = 2;
}

message UpdateStatusResponse {
  string id = 1; 
  Driver data = 2;
}

// Update Location
message UpdateLocationRequest {
  string driverId = 1;
  float lng = 2; 
  float lat = 3; 
}
message UpdateLocationResponse {
  string msg = 1;
}

// Search
message FindNearbyDriversRequest {
  float lng = 1; 
  float lat = 2; 
  float radius = 3; 
}
message FindNearbyDriversResponse {
  repeated DriverWithLocation drivers = 1;
}

// Get Profile
message GetDriverProfileRequest {
  string driverId = 1; 
}

message GetDriverProfileResponse {
  Driver data = 1;
}

// Accept Trip 
message AcceptTripRequest {
  string driverId = 1; 
  string tripId = 2; 
}

message AcceptTripResponse {
  Driver data = 1;
}

// Reject Trip
message RejectTripRequest {
  string driverId = 1;
  string tripId = 2;
}

message RejectTripResponse {
  bool success = 1;
  string message = 2;
}

message Driver {
  string id = 1;
  DriverStatusWrapper status = 2;
  float currentLat = 3;
  float currentLng = 4;
  string currentTripId = 5;
}

message DriverWithLocation {
  string driverId = 1; 
  float distance = 2; 
  Coordinate coord = 3;
}

message Coordinate {
  float lng = 1; 
  float lat = 2;
}

